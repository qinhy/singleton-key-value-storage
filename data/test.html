<html>
    <head>
    <title>Demo Chat</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js">

    </script>
    <script src="https://cdn.tailwindcss.com">

    </script>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@13.0.1/dist/markdown-it.min.js">

    </script>
<style>/* ! tailwindcss v3.3.3 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.absolute{position:absolute}.relative{position:relative}.inset-y-0{top:0px;bottom:0px}.right-0{right:0px}.order-1{order:1}.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:0.5rem}.ml-2{margin-left:0.5rem}.mt-4{margin-top:1rem}.inline-block{display:inline-block}.flex{display:flex}.inline-flex{display:inline-flex}.h-6{height:1.5rem}.w-6{width:1.5rem}.w-full{width:100%}.max-w-xl{max-width:36rem}.rotate-90{--tw-rotate:90deg;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.flex-col{flex-direction:column}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.rounded-md{border-radius:0.375rem}.border-t-2{border-top-width:2px}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity))}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235 / var(--tw-bg-opacity))}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity))}.bg-gray-300{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68 / var(--tw-bg-opacity))}.p-3{padding:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.pl-12{padding-left:3rem}.pt-4{padding-top:1rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.font-light{font-weight:300}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity))}.placeholder-gray-600::placeholder{--tw-placeholder-opacity:1;color:rgb(75 85 99 / var(--tw-placeholder-opacity))}.transition{transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-500{transition-duration:500ms}.ease-in-out{transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1)}.hover\:bg-blue-400:hover{--tw-bg-opacity:1;background-color:rgb(96 165 250 / var(--tw-bg-opacity))}.focus\:placeholder-gray-400:focus::placeholder{--tw-placeholder-opacity:1;color:rgb(156 163 175 / var(--tw-placeholder-opacity))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}@media (min-width: 640px){.sm\:mb-0{margin-bottom:0px}.sm\:flex{display:flex}}</style>
</head>

<body>
    <div id="app" class="max-w-xl mx-auto">
        <div id="messages" class="flex flex-col space-y-4 p-3 overflow-y-auto scrollbar-thumb-blue scrollbar-thumb-rounded scrollbar-track-blue-lighter scrollbar-w-2 scrolling-touch">
        <div class="chat-message">
        <div class="flex items-end">
        <img src="https://uxwing.com/wp-content/themes/uxwing/download/tools-equipment-construction/configuration-icon.svg" alt="My profile" class="w-6 h-6 rounded-full order-0"> <span class="px-4 py-2 rounded-lg inline-block bg-red-500 text-white">あなたは英語と日本語の両方に熟練した役立つassistantです。コンピュータのコマンドを除いて、すべての返信が日本語であることを確認してください。</span>
    </div>
</div>
    <div class="chat-message">
        <div class="flex items-end justify-end">
        <img src="https://uxwing.com/wp-content/themes/uxwing/download/arts-graphic-shapes/designer-artist-icon.svg" alt="My profile" class="w-6 h-6 rounded-full order-1">
        <span class="px-4 py-2 rounded-lg inline-block bg-blue-600 text-white">できること教えて</span>
    </div>
</div>
    <div class="chat-message">
        <div class="flex items-end">
        <img src="https://uxwing.com/wp-content/themes/uxwing/download/tools-equipment-construction/setting-line-icon.svg" alt="My profile" class="w-6 h-6 rounded-full order-0"> <span class="px-4 py-2 rounded-lg inline-block bg-gray-300 text-gray-600">私は以下のことができます：<br>
        <br>1. ウェブサイトの情報をブラウズする<br>2. テキストファイルを書き込む<br>3. ファイルを読み込む<br>4. テキストファイルを検索する<br>
        <br>具体的なタスクや要件があれば、お知らせください。</span>
    </div>
</div>
    <div class="chat-message">
        <div class="flex items-end justify-end">
        <img src="https://uxwing.com/wp-content/themes/uxwing/download/arts-graphic-shapes/designer-artist-icon.svg" alt="My profile" class="w-6 h-6 rounded-full order-1"> <span class="px-4 py-2 rounded-lg inline-block bg-blue-600 text-white">もっと詳しく</span>
    </div>
</div>
    <div class="chat-message">
        <div class="flex items-end">
        <img src="https://uxwing.com/wp-content/themes/uxwing/download/tools-equipment-construction/setting-line-icon.svg" alt="My profile" class="w-6 h-6 rounded-full order-0"> 
        <span class="break-all px-4 py-2 rounded-lg inline-block bg-gray-300 text-gray-600">もちろんです！以下に私が行える具体的なタスクや機能について詳しく説明します：<br>
        <br>1. ウェブサイトの情報をブラウズする：<br>   - 指定されたURLリンクからウェブサイトの情報を取得します。<br>   - 取得した情報を保存するためのファイル名を指定することもできます。<br>
        <br>2. テキストファイルを書き込む：<br>   - 指定されたテキストをファイルに書き込むことができます。<br>   - 書き込むファイル名やエンコーディング形式を指定することができます。<br>
        <br>3. ファイルを読み込む：<br>   - 様々な種類のファイル（.txt、.json、.xml、.yaml、.yml、.ini、.conf、.html、.htm、.docx、.rtf、.tex、.log、.xlsx、.xls、.pdf）を読み込むことができます。<br>   - ファイル名を指定するだけで、ファイルの内容を取得することができます。<br>
        <br>4. テキストファイルを検索する：<br>   - 指定されたテキストファイルを小さなセグメントに分割し、クエリを使用してそれらを検索することができます。<br>   - 検索対象のクエリとテキストファイル名を指定することで、該当する部分を検索することができます。<br>
        <br>これらの機能を使用して、様々なタスクや要件を実行することができます。ご希望のタスクや要件があれば、お知らせください。</span>
    </div>
</div>
</div> <div class="mt-4 flex flex-col max-w-xl mx-auto space-y-4 p-3 overflow-y-auto overflow-x-hidden">
        <p class="font-light text-lg">
        <span style="color: red;">AI :</span>
            </p>
        </div> <form class="border-t-2 border-gray-200 px-4 pt-4 mb-2 sm:mb-0">
                <div class="relative flex">
                <span class="absolute inset-y-0 flex items-center">

            </span> <input type="text" role="question" placeholder="hi!" class="w-full focus:outline-none focus:placeholder-gray-400 text-gray-600 placeholder-gray-600 pl-12 bg-gray-200 rounded-md py-3"> <div class="absolute right-0 items-center inset-y-0 sm:flex">
                <button type="submit" class="inline-flex items-center justify-center rounded-lg px-4 py-3 transition duration-500 ease-in-out text-white bg-blue-500 hover:bg-blue-400 focus:outline-none">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-6 w-6 ml-2 transform rotate-90">
                <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z">

            </path>
            </svg>
            </button>
            </div>
            </div>
            </form>
        </div>
    <script>
        window['VUE']=new Vue({
            el: '#app',
            data: {                        
                roleImageMap: {
                    'assistant': 'https://uxwing.com/wp-content/themes/uxwing/download/tools-equipment-construction/setting-line-icon.svg',
                    'user': 'https://uxwing.com/wp-content/themes/uxwing/download/arts-graphic-shapes/designer-artist-icon.svg',
                    'system': 'https://uxwing.com/wp-content/themes/uxwing/download/tools-equipment-construction/configuration-icon.svg',
                    'function': 'https://via.placeholder.com/50?text=F',
                    'guest': 'https://via.placeholder.com/50?text=guest',
                    'vip': 'https://via.placeholder.com/50?text=vip',
                    'bot': 'https://via.placeholder.com/50?text=bot',
                    'support': 'https://via.placeholder.com/50?text=support',
                    'developer': 'https://via.placeholder.com/50?text=developer',
                    'manager': 'https://via.placeholder.com/50?text=manager',
                    'default': 'https://via.placeholder.com/50?text=default'
                },
                roleClassMap: {
                    'assistant': { background: 'bg-gray-300', textColor: 'text-gray-600' },
                    'user': { background: 'bg-blue-600', textColor: 'text-white' },
                    'system': { background: 'bg-red-500', textColor: 'text-white' },
                    'function': { background: 'bg-green-500', textColor: 'text-white' },
                    'guest': { background: 'bg-yellow-400', textColor: 'text-black' },
                    'vip': { background: 'bg-purple-500', textColor: 'text-white' },
                    'bot': { background: 'bg-indigo-500', textColor: 'text-white' },
                    'support': { background: 'bg-pink-400', textColor: 'text-white' },
                    'developer': { background: 'bg-teal-500', textColor: 'text-white' },
                    'manager': { background: 'bg-orange-500', textColor: 'text-black' },
                    'default': { background: 'bg-white', textColor: 'text-black' }
                },
                text_decoder: new TextDecoder(),
                query: '',
                answer: '',
                processing:false,
                messages: [
                        //    {role:'assistant',
                        //     content: "Command was run with root privileges. I'm sure about that.I've update the description so it's more obviously now."
                        //     },
                        //     {role:'user',
                        //     content: "Any updates on this issue? I'm getting the same error when trying to install devtools. Thanks"
                        //     }
                        ]
            },
            methods: {
                buildVueMsg(e) {
                    const img = this.roleImageMap[e.role] || this.roleImageMap['default'];
                    const classes = this.roleClassMap[e.role] || this.roleClassMap['default'];

                    var res = {
                        role: e.role,
                        content: e.content !== '' ? e.content : (e.function_call?.arguments || ''),
                        img: img,
                        class: classes
                    };
                    res.content = res.content.split('\n').join('<br class="max-w-xl mx-auto"/>');
                    return res;
                },
                isProcessing: function () {
                    return this.processing
                },
                onSubmit: async function () {
                    this.messages.push(this.buildVueMsg({role:'user',color:'blue',content:this.query}));
                    this.$nextTick(() => {window.scrollTo(0, document.body.scrollHeight);});
                    this.processing = true
                    const response = await fetch("/ask", {
                        method: 'POST',
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            question: this.query!=''?this.query:'hi!',
                        }),
                    });                    
                    this.query='';
                    const reader = response.body.getReader();
                    while (true) {
                        const { value, done } = await reader.read();
                        if (done){
                            this.answer = '';                            
                            const response_msgs = await fetch("/send_openai_info")
                            response_msgs.json().then(data=>this.messages = data.map(e=>this.buildVueMsg(e)));                            
                            this.$nextTick(() => {window.scrollTo(0, document.body.scrollHeight);});
                            break;
                        }
                        this.answer += this.text_decoder.decode(value);
                        this.$nextTick(() => {window.scrollTo(0, document.body.scrollHeight);});
                    }                    
                    this.processing = false
                },
            },
        });
    </script>


</body>
</html>